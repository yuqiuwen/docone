"use strict";(self.webpackChunkdocone=self.webpackChunkdocone||[]).push([[5913],{3905:(e,t,n)=>{n.d(t,{Zo:()=>g,kt:()=>m});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),p=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},g=function(e){var t=p(e.components);return i.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,m=c["".concat(s,".").concat(d)]||c[d]||u[d]||a;return n?i.createElement(m,o(o({ref:t},g),{},{components:n})):i.createElement(m,o({ref:t},g))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<a;p++)o[p]=n[p];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},36243:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var i=n(87462),r=(n(67294),n(3905));const a={title:"Git Notes",authors:"Qiuwen",description:"Git\u5e38\u7528\u547d\u4ee4\u53caGitLab CI/CD\u4ecb\u7ecd",tags:["Git"],date:"2023-04-12 11:46"},o=void 0,l={permalink:"/docone/blog/2023/04/12/git-notes/Git Notes",source:"@site/blog/2023-04-12-git-notes/Git Notes.md",title:"Git Notes",description:"Git\u5e38\u7528\u547d\u4ee4\u53caGitLab CI/CD\u4ecb\u7ecd",date:"2023-04-12T11:46:00.000Z",formattedDate:"April 12, 2023",tags:[{label:"Git",permalink:"/docone/blog/tags/git"}],readingTime:7.36,hasTruncateMarker:!1,authors:[{name:"Qiuwen",title:"Front-End & Back-End Engineer @ Facebook",url:"https://github.com/yuqiuwen",key:"Qiuwen"}],frontMatter:{title:"Git Notes",authors:"Qiuwen",description:"Git\u5e38\u7528\u547d\u4ee4\u53caGitLab CI/CD\u4ecb\u7ecd",tags:["Git"],date:"2023-04-12 11:46"},nextItem:{title:"python\u534f\u7a0b\u6848\u4f8b",permalink:"/docone/blog/2022/12/14/python-notes/python\u534f\u7a0b\u6848\u4f8b"}},s={authorsImageUrls:[void 0]},p=[{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:2},{value:"\u521b\u5efa\u5206\u652f",id:"\u521b\u5efa\u5206\u652f",level:2},{value:"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f",id:"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f",level:4},{value:"\u57fa\u4e8e\u5f53\u524d\u5206\u652f\u521b\u5efa\u65b0\u5206\u652f",id:"\u57fa\u4e8e\u5f53\u524d\u5206\u652f\u521b\u5efa\u65b0\u5206\u652f",level:4},{value:"\u4ecedevelop\u5206\u652f\u62c9\u51fa\u4e00\u4e2a\u65b0\u529f\u80fd\u5206\u652f",id:"\u4ecedevelop\u5206\u652f\u62c9\u51fa\u4e00\u4e2a\u65b0\u529f\u80fd\u5206\u652f",level:4},{value:"\u4ecedevelop\u62c9\u51fa\u4e00\u4e2arelease\u5206\u652f",id:"\u4ecedevelop\u62c9\u51fa\u4e00\u4e2arelease\u5206\u652f",level:4},{value:"\u521b\u5efa\u7a7a\u767d\u5206\u652f",id:"\u521b\u5efa\u7a7a\u767d\u5206\u652f",level:4},{value:"\u5206\u652f\u7c7b\u578b",id:"\u5206\u652f\u7c7b\u578b",level:2},{value:"\u63d0\u4ea4\u89c4\u8303",id:"\u63d0\u4ea4\u89c4\u8303",level:2},{value:"\u751f\u6210\u5bc6\u94a5\u5bf9",id:"\u751f\u6210\u5bc6\u94a5\u5bf9",level:2},{value:"GitLab CI/CD",id:"gitlab-cicd",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2}],g={toc:p};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,i.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/34802521/1676526963937-985a1e25-147d-4238-bf5a-8c0266b52370.png#averageHue=%23fdfdfd&clientId=ua9e4881a-da29-4&from=paste&height=438&id=ubf9bed0c&originHeight=1178&originWidth=1320&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=uf78ad4d5-9e92-4fae-ba7b-aae3581f98d&title=&width=491.15338134765625",alt:null}),"\n\u529f\u80fd\u5f00\u53d1/\u4fee\u590d\u5b8c\u6210\u540e\u5408\u5e76\u5230develop\uff0c\u6d4b\u8bd5\u901a\u8fc7\u540e\u57fa\u4e8emaster\u521b\u5efa\u53d1\u5e03\u5206\u652frelease\uff0crelease\u5408\u5e76\u5f00\u53d1/\u4fee\u590d\u5206\u652f\u540e\uff0c\u90e8\u7f72\u4e0a\u7ebf\uff0c \u9a8c\u6536\u901a\u8fc7\u5e76\u5c01\u7248\u540e\u5408\u5230master\uff0c\u770b\u9700\u8981\u6765\u6253tag"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5f00\u53d1/\u7f3a\u9677\u5206\u652f\u53ea\u80fd\u5408\u5e76\u7a33\u5b9a\u5206\u652f\u4f8b\u5982\u53ef\u4ee5\u5408\u5e76master\u5206\u652f\uff0c\u4e0d\u53efmerge develop\u5206\u652f\uff0c\u4f5c\u7528\u662f\u9632\u6b62\u73af\u5883 \u6c61\u67d3 "),(0,r.kt)("li",{parentName:"ul"},"develop\u5206\u652f\u53ea\u80fd\u7528\u4e8e\u6d4b\u8bd5\u73af\u5883\u53d1\u5e03\uff0c\u4e0d\u53ef\u76f4\u63a5\u5408\u5e76\u5230release\u5206\u652f\uff0c\u6b63\u786e\u6d41\u7a0b\u662f\u5728release\u5206\u652f\u5408\u5e76\u5f00 \u53d1/\u7f3a\u9677\u5206\u652f")),(0,r.kt)("h2",{id:"\u5e38\u7528\u547d\u4ee4"},"\u5e38\u7528\u547d\u4ee4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# \u67e5\u770bgit\u914d\u7f6e\ngit config -l\n\n# \u67e5\u770bgit\u7528\u6237\u540d \u90ae\u7bb1\ngit config user.name\ngit config user.email\n\n# \u4fee\u6539\u7528\u6237\u540d\ngit config --global user.name {\u7528\u6237\u540d}\n\ngit remote -v   \u663e\u793a\u6240\u6709\u8fdc\u7a0b\u4ed3\u5e93\ngit remote prune origin      \u5220\u9664\u672c\u5730\u6709\u4f46\u5728\u8fdc\u7a0b\u5e93\u5df2\u7ecf\u4e0d\u5b58\u5728\u7684\u5206\u652f\ngit clone -b   \u514b\u9686\u5206\u652f\u540d \u5730\u5740\ngit remote add origin git@github.com:XXXXX/demo.git   \u65b0\u589e\u8fdc\u7a0b\u4ed3\u5e93\ngit remote set-url origin git@github.com:XXXXX/demo.git  \u4fee\u6539\u8fdc\u7a0b\u4ed3\u5e93\ngit remote set-url --add origin git@github.com:XXXXX/demo.git  \u6dfb\u52a0\u591a\u4e2a\u8fdc\u7a0b\u4ed3\u5e93\n\ngit stash    \u4e0d\u63d0\u4ea4\u5de5\u4f5c\u533a\u5185\u5bb9\ngit stash pop \u6062\u590d\u5de5\u4f5c\u533a\ngit fetch   \u62c9\u53d6\u8fdc\u7a0b\u5206\u652f\ngit checkout -b develop origin/develop \ngit reset --hard <commit ID\u53f7> \u56de\u6eda\n\ngit push -f origin master \u63a8\u9001\u5230\u8fdc\u7a0b\u5206\u652f \ngit diff    \u67e5\u770b\u5de5\u4f5c\u533a\u548c\u6682\u5b58\u533a\u7684\u533a\u522b \ngit diff \u2013cached    \u67e5\u770b\u6682\u5b58\u533a\u548c\u7248\u672c\u5e93\u4e4b\u95f4\u7684\u533a\u522b \ngit diff HEAD   \u67e5\u770b\u5de5\u4f5c\u533a\u548c\u7248\u672c\u5e93\u4e4b\u95f4\u7684\u533a\u522b \ngit status   \u67e5\u770b\u5f53\u524d\u7684\u5de5\u4f5c\u72b6\u6001\n\ngit branch -a \u67e5\u770b\u672c\u5730\u6240\u6709\u5206\u652f\ngit branch -r \u67e5\u770b\u8fdc\u7a0b\u6240\u6709\u5206\u652f\ngit push --set-upstream origin online_help_20191024   \u63a8\u5206\u652f\ngit push origin --delete dev20181018    \u5220\u9664\u8fdc\u7a0b\u5206\u652f\ngit branch -d dev20181018   \u5220\u9664\u672c\u5730\u5206\u652f\ngit cherry-pick 285c9477a759abdee94099e25e75e39e8c77d46b \u5408\u5e76\u6307\u5b9a\u7248\u672c\n\n")),(0,r.kt)("h2",{id:"\u521b\u5efa\u5206\u652f"},"\u521b\u5efa\u5206\u652f"),(0,r.kt)("h4",{id:"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f"},"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-git"},"git branch <new_branch_name>\ngit checkout <new_branch_name>\n")),(0,r.kt)("h4",{id:"\u57fa\u4e8e\u5f53\u524d\u5206\u652f\u521b\u5efa\u65b0\u5206\u652f"},"\u57fa\u4e8e\u5f53\u524d\u5206\u652f\u521b\u5efa\u65b0\u5206\u652f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-git"},"# \u4ecemain\u5206\u652f\u521b\u5efadevelop\u5206\u652f\u5e76\u5207\u6362\u5230develop\ngit pull origin main \uff08\u53ef\u9009\uff09\ngit checkout -b develop main\n# \u53d1\u5e03develop\u5206\u652f\uff0c\u4f7f\u672c\u5730\u5206\u652f\u4e0e\u8fdc\u7a0bdevelop\u5173\u8054\ngit push -u origin develop\n\n\n# \u53d1\u5e03\u5230main\u5206\u652f\ngit checkout main                   # \u5207\u6362\u5230main\u5206\u652f\ngit merge --no-ff develop           # \u5bf9develop\u5206\u652f\u8fdb\u884c\u5408\u5e76\n\n--no-ff \n\u7981\u6b62\u4f7f\u7528\u5feb\u901f\u5408\u5e76\u6a21\u5f0f\uff0c\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u63d0\u4ea4\uff0c\u53ef\u4ee5\u56de\u9000\u5230main\u7684\u4e0a\u4e00\u6b21\u63d0\u4ea4\u72b6\u6001\uff0c\n\u5982\u679c\u4e0d\u52a0\u6b64\u53c2\u6570\u7684\u8bdd\uff0c\u53ea\u80fd\u56de\u5230develop\u7684\u4e0a\u4e00\u6b21\u63d0\u4ea4\n")),(0,r.kt)("h4",{id:"\u4ecedevelop\u5206\u652f\u62c9\u51fa\u4e00\u4e2a\u65b0\u529f\u80fd\u5206\u652f"},"\u4ecedevelop\u5206\u652f\u62c9\u51fa\u4e00\u4e2a\u65b0\u529f\u80fd\u5206\u652f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-git"},"git pull origin develop \uff08\u53ef\u9009\uff09\ngit checkout -b feature_v1.0 develop\ngit push -u origin feature_v1.0\n\n# \u5b8c\u6210\u540e\uff0c\u5408\u5e76\u5230develop\u5206\u652f\ngit pull origin develop\ngit checkout develop\ngit merge --no-ff feature_v1.0          # \u4ecefeature\u5206\u652f\u5408\u5e76\u5230develop\u5206\u652f\ngit branch -d feature_v1.0                  # \u5220\u9664feature\u5206\u652f\uff0c\u53ef\u9009\n")),(0,r.kt)("h4",{id:"\u4ecedevelop\u62c9\u51fa\u4e00\u4e2arelease\u5206\u652f"},"\u4ecedevelop\u62c9\u51fa\u4e00\u4e2arelease\u5206\u652f"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-git"},"git pull origin develop                             #\u53ef\u9009\uff0c\u83b7\u53d6\u6700\u65b0\u7248\u672c\ngit checkout -b release_v1.0 develop\n\n# \u5b8c\u6210release\uff0c\u5408\u5e76\u5230main\u5206\u652f\u548cdevelop\u5206\u652f\uff0c\u5728main\u6253\u4e0atag\u6807\u8bb0\ngit checkout main\ngit merge --no-ff release_v1.0\ngit tag release1.0 master\ngit push --tags\n\n#\u5408\u5e76\u5230develop\ngit checkout develop\ngit merge --no-ff release_v1.0\n\n")),(0,r.kt)("h4",{id:"\u521b\u5efa\u7a7a\u767d\u5206\u652f"},"\u521b\u5efa\u7a7a\u767d\u5206\u652f"),(0,r.kt)("p",null,"\u5982\u679c\u9879\u76ee\u9700\u8981\u91cd\u6784\uff0c\u65b0\u9879\u76ee\u4e0d\u4f9d\u8d56\u4e8e\u65e7\u9879\u76ee"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-git"},'git checkout --orphan newBranch\n\ngit rm -rf .        # \u5982\u679c\u60f3\u8981\u5220\u9664\u65e7\u4ee3\u7801\ngit add .gitignore\ngit commit -m "Init an empty branch"\ngit push -u origin develop      # \u548c\u8fdc\u7a0b\u5206\u652f\u5173\u8054\n')),(0,r.kt)("h2",{id:"\u5206\u652f\u7c7b\u578b"},"\u5206\u652f\u7c7b\u578b"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/34802521/1678679735611-36260812-5d4d-4c42-97ad-fe7beecc7916.png#averageHue=%23f0dfd9&clientId=uad1ce3dc-a63b-4&from=paste&id=u562805a8&originHeight=327&originWidth=532&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=uf4dc8fe7-e224-4542-85f7-6001f6498d5&title=",alt:null})),(0,r.kt)("p",null,"\u5f00\u53d1\u5206\u652f: feat/xxx(\u529f\u80fd)_20200804(\u521b\u5efa\u65e5\u671f)\u5f00\u53d1\u5206\u652f\u57fa\u4e8emaster\u521b\u5efa\uff0c\u5f00\u53d1\u5b8c\u6210\u5408\u5e76\u5230\u6d4b\u8bd5develop\u5206\u652f\n\u6d4b\u8bd5\u5206\u652f\uff1adevelop \u53ea\u7528\u6765\u53d1\u5e03\u6d4b\u8bd5\u73af\u5883\n\u53d1\u5e03\u5206\u652f\uff1arelease/vx.x.x(\u7248\u672c\u53f7)_20200804(\u521b\u5efa\u65e5\u671f)\uff0c\u57fa\u4e8emaster\u521b\u5efa\uff0c\u9a8c\u6536\u5b8c\u6210\uff0c\u8fdb\u884c\u5c01\u7248\u540e\u5408\u5e76\u56demaster\n\u7f3a\u9677\u5206\u652f\uff1ahotfix/xxx(\u529f\u80fd)_20200804(\u521b\u5efa\u65e5\u671f)\u5408\u5e76\u6d41\u7a0b\u548c\u5f00\u53d1\u5206\u652f\u4e00\u81f4\uff0c\u533a\u522b\u5728\u4e8e\uff0chotfix\u5728\u6d4b\u8bd5\u73af\u5883\u6d4b\u8bd5\u901a\u8fc7\u540e\u76f4\u63a5\u5408\u5230\u6700\u65b0\u7684release\u5206\u652f\u9a8c\u6536"),(0,r.kt)("h2",{id:"\u63d0\u4ea4\u89c4\u8303"},"\u63d0\u4ea4\u89c4\u8303"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-markdown"},"commit \u89c4\u8303\uff1a\n\nfeat: \u2f00\u4e2a\u65b0\u7279\u6027\n\nfix: \u4fee\u4e86\u2f00\u4e2a Bug\n\ndocs: \u66f4\u65b0\u4e86\u2f42\u6863\uff08\u2f50\u5982\u6539\u4e86 Readme\uff09\n\nstyle: \u4ee3\u7801\u7684\u6837\u5f0f\u7f8e\u5316\uff0c\u4e0d\u6d89\u53ca\u5230\u529f\u80fd\u4fee\u6539\uff08\u2f50\u5982\u6539\u4e86\u7f29\u8fdb\uff0ccss\u4fee\u6539\u4e0d\u7b97\uff09\n\nrefactor: \u2f00\u4e9b\u4ee3\u7801\u7ed3\u6784\u4e0a\u4f18\u5316\uff0c\u65e2\u4e0d\u662f\u65b0\u7279\u6027\u4e5f\u4e0d\u662f\u4fee Bug\uff08\u2f50\u5982\u51fd\u6570\u6539\u4e2a\u540d\u5b57\uff09\n\nperf: \u4f18\u5316\u4e86\u6027\u80fd\u7684\u4ee3\u7801\u6539\u52a8\n\ntest: \u65b0\u589e\u6216\u8005\u4fee\u6539\u5df2\u6709\u7684\u6d4b\u8bd5\u4ee3\u7801\n\nchore: \u8ddf\u4ed3\u5e93\u4e3b\u8981\u4e1a\u52a1\u2f46\u5173\u7684\u6784\u5efa/\u2f2f\u7a0b\u4f9d\u8d56/\u2f2f\u5177\u7b49\u529f\u80fd\u6539\u52a8\uff08\u2f50\u5982\u65b0\u589e\u2f00\u4e2a\u2f42\u6863\u2f63\u6210\u2f2f\u5177\uff09\n\n\u64cd\u4f5c\u89c4\u8303\uff08\u6280\u5de7\uff09\uff1a\n\n\u5728\u4ee3\u7801push \u524d\u5148 pull\n\u9047\u5230\u4ee3\u7801\u51b2\u7a81\u65f6\uff0c\u6700\u5148\u8003\u8651\u53d6\u6700\u8fd1commit\u7684\u7248\u672c\uff0c\u82e5\u60f3\u64a4\u9500\u672c\u6b21\u62c9\u53d6 \u6267\u884cgit revert --abort\n\u6b63\u5728\u5f00\u53d1\u53d1\u73b0\u5206\u652f\u9519\u4e86\uff0c\u6267\u884c git stash\uff0c\u5207\u6362\u5206\u652f\u540e\uff0c\u6267\u884cgit stash pop\n\u53ea\u60f3\u5408\u5e76\u5176\u4ed6\u5206\u652f\u7684\u67d0\u6761commit \u8bb0\u5f55 \u6267\u884c git cherry-pick commitId\n\u5f00\u53d1\u5206\u652f\u65b0\u5efa\u5fc5\u987b\u57fa\u4e8e\u5e72\u51c0\u7248\u672c\uff0c\u5408\u5e76\u5230\u7a33\u5b9a\u7248\u672c\u524d\u5fc5\u987b\u662f\u9a8c\u6536\u901a\u8fc7\u7684\u7248\u672c\n\u5f00\u53d1\u5206\u652f\u4e0d\u80fd\u5408\u5e76\u5176\u4ed6\u6b63\u5728\u5f00\u53d1\u6216\u8005\u975e\u5e72\u51c0\u5206\u652f\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.nlark.com/yuque/0/2023/png/34802521/1676344830247-fba2e1c6-00db-497a-a406-5aa44e6ea1ad.png#averageHue=%23faf3f3&clientId=u9786eaac-ae45-4&from=paste&height=297&id=u1fb16caf&originHeight=593&originWidth=840&originalType=url&ratio=1.100000023841858&rotation=0&showTitle=false&status=done&style=none&taskId=u2ffc42b6-6a77-4fec-971d-c8b5b0870ff&title=&width=420",alt:null})),(0,r.kt)("h2",{id:"\u751f\u6210\u5bc6\u94a5\u5bf9"},"\u751f\u6210\u5bc6\u94a5\u5bf9"),(0,r.kt)("p",null,"ssh-keygen -t rsa -C \u90ae\u7bb1\u540d\n.pub\u6587\u4ef6\u5c31\u662f\u516c\u94a5\uff0c\u5185\u5bb9\u62f7\u8d1d\u81f3gitlab ssh keys\u4e2d"),(0,r.kt)("h2",{id:"gitlab-cicd"},"GitLab CI/CD"),(0,r.kt)("p",null,"\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa.gitlab-ci.yml\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'variables:\n  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"\n\n# \u7f13\u5b58\u914d\u7f6e\uff0c\u52a0\u5feb\u9879\u76ee\u7684\u6784\u5efa\u901f\u5ea6\uff0c\u51cf\u5c11\u91cd\u590d\u4e0b\u8f7d\ncache:\n  key: $CI_JOB_NAME-$CI_COMMIT_REF_SLUG # job\u540d\u79f0-\u63d0\u4ea4\u7684\u5206\u652f\u540d\u79f0\n  paths:\n    - ${PIP_CACHE_DIR}      # \u9700\u8981\u88ab\u7f13\u5b58\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u8def\u5f84\n\n# \u5b9a\u4e49pipeline\nstages:\n  - lint\n  - test\n\n# \u5b9a\u4e49\u4e862\u4e2ajob\nlint_job:\n  stage: lint               # \u5c5e\u4e8e\u54ea\u4e2astage\n  image: python:3.7 # \u9700\u8981\u7684docker\u955c\u50cf\n  before_script:        # job\u5f00\u59cb\u4e4b\u524d\u6267\u884c\u7684\u811a\u672c\n    - pip install flake8 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com\n  script:                       # \u6267\u884c\u811a\u672c\n    - flake8 app\n\ntest_job:\n  stage: test\n  image: python:3.7\n  services: # \u542f\u52a8\u540d\u4e3a postgres \u7684\u670d\u52a1\n    - postgres\n  variables:\n    POSTGRES_HOST: postgres\n    POSTGRES_PORT: 5432\n    POSTGRES_USER: postgres\n    POSTGRES_PASS: postgres\n    POSTGRES_DB: oa_performance_test\n    POSTGRES_PASSWORD: postgres\n  before_script:\n    - pip install -r requirements-test.txt -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com\n  script:\n    - echo "Test started."\n    # - coverage run --source app -m pytest tests\n    # - coverage report\n    - echo "Test finished."\n\n')),(0,r.kt)("h2",{id:"\u5e38\u89c1\u95ee\u9898"},"\u5e38\u89c1\u95ee\u9898"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"fatal: refusing to merge unrelated histories"))),(0,r.kt)("p",null,"git merge main --allow-unrelated-histories"),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"})))}c.isMDXComponent=!0}}]);